# 原始输入协议（多人多角色，文本版）

> 目标：不开发平台，仅靠文件夹与文本读写，支持多人在同一轮提交多角色对白与行动。
> 原则：保留 AI DM 的高裁量权，不把 DM 变成流程机。

---

## 1. 适用场景

- 多名玩家围桌，每人可控制 1 个或多个角色。
- 一次输入中同时包含：对白、战术、探索、临时请求。
- DM 需要在不丢失叙事自由的前提下，稳定处理“批量输入”。

---

## 2. 核心原则（DM主权）

1. 玩家输入是提议，不是命令。
2. DM 拥有完整信息访问权和最终裁决权。
3. DM 可根据世界逻辑重排顺序、插入事件、判定部分输入无效或顺延。
4. DM 必须说明关键裁决理由（至少一句），避免多人误解。

---

## 3. 输入建议格式（推荐，不强制，支持多种写法）

玩家可自由表达；AI DM 需要兼容多种输入形式，并统一解析为“角色意图列表”。

可接受的常见格式（示例）：

```text
【格式A：分段结构】
【对白】
赵雨桐：「我们先听听隧道动静。」
林立：「我不同意，我要先搜补给箱。」

【行动】
赵雨桐：贴墙侦查西侧通道，若听到脚步就回撤。
林立：搜索补给箱，优先药品和电池。

【补充】
若遭遇敌人：赵雨桐优先示警，林立优先撤退。
```

```text
【格式B：逐行行动】
赵雨桐：侦查西侧通道，听到脚步就撤。
林立：搜补给箱，先找药品和电池。
```

```text
【格式C：自然语言混合】
赵雨桐先去听隧道动静，林立去搜箱子。
要是有敌人，赵雨桐示警，林立马上后撤。
```

最小标识要求：
- 每条行动写明“角色名 + 意图”。
- 一条消息里可写多个角色。
- 可加“若失败/若冲突时的备选动作”。

默认顺序规则：
- 玩家未明确写“同时/并行/等待信号/触发条件”时，按书写顺序先后执行。
- 玩家明确并行时，DM 可按情境重排，但要说明重排原因。
- 行动互斥时，DM 可部分采纳、顺延或中断，并给出一句以上理由。

---

## 4. DM 处理方法（弱约束，不是状态机）

### 4.1 先整体理解，再执行

- 先完整读完整条输入，再拆分角色意图。
- 禁止“读到一句就立刻执行”导致上下文断裂。

### 4.2 按情境重排

- 同时行动由 DM 按危险度、位置关系、可见性、先攻关系重排。
- DM 可宣布：
  - 同步处理（同一时间片）
  - 顺序处理（先后发生）
  - 延后处理（进入下一叙事段）

### 4.3 对白与扮演

- 角色间对白默认无需检定，直接进入叙事。
- 涉及欺骗、威吓、说服、隐瞒、抢行动时再触发检定。
- 若对白已触发世界后果，后续与其矛盾的声明可判为无效。

### 4.4 无效/冲突输入处理

- 允许 DM 在回复中明确指出：
  - 哪些输入生效
  - 哪些输入部分生效
  - 哪些输入无效（以及原因）
- 推荐使用叙事化表达：
  - “林立说出那句话后，行尸已被惊动，因此‘继续潜行’本段无效。”

### 4.5 高风险确认

- 对明显不可逆且玩家可能未意识到的动作，先做一次沉浸式确认。
- 玩家确认后立即执行，不反复打断。

### 4.6 采纳行动的沉浸式描写（硬要求）

- 对“采纳/部分采纳”的行动，必须写成叙事片段，而不是只给结论清单。
- 至少交代：角色动作、环境反馈、世界反应（NPC/敌人/地形/声音等）。
- 若行动被中断，也要描述“如何被中断”，让玩家感知到现场过程。

### 4.7 `playground` 行动陈列板机制（先收录，后执行）

- 根目录 `playground.md` 是公开行动板，用来陈列各角色待处理行动。
- 收到行动输入但**未收到明确执行指令**时：DM 只收录到 `playground.md`，不结算世界后果，不推进时间。
- 执行指令示例：`执行playground`、`AI DM开始裁决`、`结算当前行动板`（同义表达也可）。
- 收到执行指令后，DM 对行动板逐条评审并标记：
  - `采纳`
  - `部分采纳`
  - `顺延`
  - `中断`
  - `驳回`
- DM 执行后必须更新 `playground.md`，并保持文档可继续接纳下一批行动。

---

## 5. DM 回包建议（提高多人可读性）

每次处理多人输入时，回复建议包含：

1. **输入解析摘要**：本次识别到哪些角色意图。
2. **裁决与顺序**：DM如何决定先后与同步。
3. **执行结果**：检定、状态变化、环境变化。
4. **无效/顺延说明**：明确写出原因。
5. **下一步可选行动**：给所有活跃角色可执行选项。

若当前只是“收录到 playground（未执行）”，回复建议额外包含：

6. **收录确认**：列出本次入板行动及当前待执行总数。
7. **执行口令提醒**：提醒玩家使用明确执行指令再进入裁决与结算。

---

## 6. 与未来前端兼容

本协议本质是“纯文本协议”：

- 当前：直接在聊天中提交文本块即可。
- 未来：前端只需把同样结构写入文本/Markdown，不需要改规则层。
- 因为 DM 裁决权保持不变，前端只做输入组织，不接管裁决。

---

## 7. 一句话标准

**多人输入可以很自由，但 DM 必须“先收录（playground）→ 再统一裁决 → 沉浸式执行 → 清晰回报”。**
